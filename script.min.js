function $url(a=window.location.search){var g,h,i,j,b=a.indexOf("?")+1,c=a.indexOf("#")+1||a.length+1,d=a.slice(b,c-1),e=d.replace(/\+/g," ").split("&"),f={};if(d!==a&&""!==d){for(g=0;g<e.length;g++)j=e[g].split("=",2),h=decodeURIComponent(j[0]),i=decodeURIComponent(j[1]),f.hasOwnProperty(h)||(f[h]=[]),f[h].push(2===j.length?i:null);return f}}document.addEventListener("contextmenu",a=>a.preventDefault());var url=$url();url="undefined"!=typeof url&&url;var mineN=15,rows=10,cols=10;if(url)switch(url.mode[0]){case"medium":rows=13,cols=15,mineN=20;break;case"hard":rows=15,cols=17,mineN=25;break;case"custom":rows=parseInt(url.rows[0]),cols=parseInt(url.cols[0]),mineN=parseInt(url.mineN[0])}$("#btn").click(a=>{a.preventDefault(),rows=$("#rows").val(),cols=$("#cols").val(),mineN=$("#mines").val(),window.location.replace(`?mode=custom&rows=${rows}&cols=${cols}&mineN=${mineN}`)});for(var Cell=function(a,b,c,d){this.id=a,this.mine=b,this.border=0,this.quantumstate=!1,this.flag=!1,this.table={row:c,col:d},this.near={up:this.id-cols,upright:this.id-(cols-1),right:this.id+1,downright:this.id+(cols+1),down:this.id+cols,downleft:this.id+(cols-1),left:this.id-1,upleft:this.id-(cols+1)},1!=c&&c!=rows&&1!=d&&d!=cols||(this.border=1,1==c&&(this.near.up=!1,this.near.upleft=!1,this.near.upright=!1),c==rows&&(this.near.down=!1,this.near.downleft=!1,this.near.downright=!1),1==d&&(this.near.upleft=!1,this.near.left=!1,this.near.downleft=!1),d==cols&&(this.near.upright=!1,this.near.right=!1,this.near.downright=!1))},gridCellId=0,Cells=[],Mines=[],Flags=[],i=0;i<rows;i++){$("#minefield").append("<div class='row'></div>");for(var i2=0;i2<cols;i2++)$(".row").last().append(`<div class=col><span mine=false class=gridCell cell-id=${gridCellId}></span></div>`),Cells[gridCellId]=new Cell(gridCellId,!1,i+1,i2+1),gridCellId++}for(var i3=0;i3<mineN;i3++){var cellN=Math.floor(Math.random()*(rows*cols));Cells[cellN].mine=!0,Mines[i3]=Cells[cellN].id,$("[cell-id="+cellN+"]").attr("mine",!0)}$(".row").css("width",33*cols);var timeoutId=0,hold=!1,cellid=null;$(".gridCell").on("mousedown",function(){cellid=parseInt($(this).attr("cell-id")),timeoutId=setTimeout(()=>{hold=!0,Cells[cellid].quantumstate||(Cells[cellid].flag?(Cells[cellid].flag=!1,$("[cell-id="+cellid+"]").css("background","#e74c3c"),Flags.splice(Flags.indexOf(cellid),1)):(Cells[cellid].flag=!0,$("[cell-id="+cellid+"]").css("background","black"),Flags.push(cellid)))},500)}).on("mouseup",function(){function b(a){return 0!=a&&Cells[a].mine}function c(a){if(0!=a||"undefined"!=typeof a){var c=0;try{b(a.near.up)&&c++,b(a.near.upright)&&c++,b(a.near.right)&&c++,b(a.near.downright)&&c++,b(a.near.down)&&c++,b(a.near.downleft)&&c++,b(a.near.left)&&c++,b(a.near.upleft)&&c++,c>0&&!a.quantumstate&&($("[cell-id="+a.id+"]").html(c),$("[cell-id="+a.id+"]").css("background","#e67e22")),0!=c||a.quantumstate||($("[cell-id="+a.id+"]").css("background","#e67e22"),a.quantumstate=!0,d(a))}catch(a){}}}function d(a){0==a&&"undefined"==typeof a||(c(Cells[a.near.up]),c(Cells[a.near.upright]),c(Cells[a.near.right]),c(Cells[a.near.downright]),c(Cells[a.near.down]),c(Cells[a.near.downleft]),c(Cells[a.near.left]),c(Cells[a.near.upleft]))}if(!hold&&!Cells[cellid].flag){Cells[cellid].mine?(alert("rip"),location.reload(),$("[cell-id="+cellid+"]").css("background","#2ecc71")):c(Cells[cellid]);$(this).attr("mine");console.log(Cells[cellid])}clearTimeout(timeoutId),hold=!1,Flags.sort().join(",")===Mines.sort().join(",")&&(alert("GG IZ"),location.reload())})